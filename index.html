<!DOCTYPE html>
<html>
<head>
  <title>Music Player</title>
  <style>
    body {
      font-family: Arial, sans-serif;
    }
    .video-container {
      position: relative;
      max-width: 100%;
      overflow: hidden;
      display: none;
      margin-bottom: 10px;
    }
    video {
      width: 100%;
      height: auto;
      display: block;
    }
    .warning {
      color: red;
      font-size: 12px;
      display: none;
    }
  </style>
</head>
<body>

<h2>Music Player</h2>

<div class="video-container" id="videoContainer">
  <video id="video" preload="auto">
    <source src="https://webproject010.github.io/Music-Media/JOJO-T3.mp4" type="video/mp4">
    Your browser does not support the video tag.
  </video>
  <div class="warning" id="warningText">Maaf, perangkat anda belum siap melakukan tindakan cepat ini.</div>
</div>

<audio id="audio1" controls>
  <source src="https://files.catbox.moe/dz2qsc.mp3" type="audio/mpeg">
</audio>

<audio id="audio2" controls>
  <source src="https://files.catbox.moe/0ixp2e.mp3" type="audio/mpeg">
</audio>

<audio id="audio3" controls>
  <source src="https://files.catbox.moe/6jj0o1.mp3" type="audio/mpeg">
</audio>

<script>
  const video = document.getElementById('video');
  const videoContainer = document.getElementById('videoContainer');
  const warningText = document.getElementById('warningText');
  const audios = document.querySelectorAll('audio');

  const videoTriggers = [
    { audio: audios[0], start: 1.0, end: 5.0 },
    { audio: audios[1], start: 1.0, end: 6.0 },
    { audio: audios[2], start: 2.0, end: 7.0 },
  ];

  let activeAudio = null;
  let trigger = null;
  let syncInterval;

  function hideVideo() {
    video.pause();
    videoContainer.style.display = 'none';
    warningText.style.display = 'none';
  }

  function showVideo() {
    videoContainer.style.display = 'block';
  }

  function resetAll() {
    audios.forEach(a => {
      a.pause();
      a.currentTime = 0;
    });
    hideVideo();
    clearInterval(syncInterval);
  }

  audios.forEach(audio => {
    audio.addEventListener('play', () => {
      resetAll();
      audio.play();
      activeAudio = audio;
      trigger = videoTriggers.find(t => t.audio === audio);

      if (trigger) {
        syncInterval = setInterval(() => {
          const currentTime = activeAudio.currentTime;

          if (currentTime >= trigger.start && currentTime <= trigger.end) {
            showVideo();

            if (Math.abs(video.currentTime - (currentTime - trigger.start)) > 0.3) {
              try {
                video.currentTime = currentTime - trigger.start;
              } catch {
                warningText.style.display = 'block';
              }
            }

            if (video.paused) {
              try {
                video.play();
              } catch {
                warningText.style.display = 'block';
              }
            }
          } else {
            hideVideo();
          }

          // Auto-hide if video ends
          if (video.ended || currentTime > trigger.end) {
            hideVideo();
          }
        }, 100);
      }
    });

    audio.addEventListener('pause', () => {
      video.pause();
    });

    audio.addEventListener('seeking', () => {
      if (trigger) {
        const seekPos = audio.currentTime;
        if (seekPos >= trigger.start && seekPos <= trigger.end) {
          try {
            video.currentTime = seekPos - trigger.start;
          } catch {
            warningText.style.display = 'block';
          }
        }
      }
    });
  });

  video.addEventListener('ended', () => {
    hideVideo();
  });
</script>

</body>
</html>
